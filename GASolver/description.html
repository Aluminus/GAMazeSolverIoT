<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=2C5971170CD50D071D8444DDD87E68CD" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:FooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=01F89A31F1103BC3B9A3B2562E9C41B3" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Genetic algorithm for 2D-Mazes solving and path optimization</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Genetic algorithm for 2D-Mazes solving and path optimization</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Visual Basic .NET
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            User Control, Stream, Genetic Algorithms
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">1/29/2015</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Genetic-algorithm-for-2D-74dd9e10">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p><em><em>The project is intended as a complement to my second article on TechNet Wiki about genetic algorithms. The program allows the creation of a 2D maze, generating solutions for it. Through each generation of solutions, it tries to find the best approach
 to solve the maze, i.e. finding the shortes route to its exit.</em></em></p>
<h1><span>Building the Sample</span></h1>
<p><em>No special requirements are needed in building the sample. Just open the solution in Visual Studio, and execute it. If you wish to use a pre-created maze, just open the file &quot;test_maze.txt&quot;, included with the current package.</em></p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p><em>In my code, i will provide the means to allow a user to draw its own 2D maze. Once finished, initial solutions will be created, evaluating the fitness for each one of them. The best are extracted, and their characteristics are combined to produce a new
 set of solutions. In executing the loop, the user will be able to see how the algorithm adapt itself to be able to solve the maze in the most efficient way. &nbsp;</em></p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">vb</span>
<pre class="hidden">' Generic Function to retrieve a 2D maze solution's domain

    Private Function Solve(_X As Integer, _Y As Integer) As Boolean
        If solverBytes(_endPos(0), _endPos(1)) = CELLSTATE.Valid Then Return True

        If solverBytes(_X &#43; 1, _Y) = CELLSTATE.Free Or solverBytes(_X &#43; 1, _Y) = CELLSTATE.Start Or solverBytes(_X &#43; 1, _Y) = CELLSTATE.Finish Then
            solverBytes(_X &#43; 1, _Y) = CELLSTATE.Valid
            If Solve(_X &#43; 1, _Y) Then Return True
        End If

        If solverBytes(_X - 1, _Y) = CELLSTATE.Free Or solverBytes(_X - 1, _Y) = CELLSTATE.Start Or solverBytes(_X - 1, _Y) = CELLSTATE.Finish Then
            solverBytes(_X - 1, _Y) = CELLSTATE.Valid
            If Solve(_X - 1, _Y) Then Return True
        End If

        If solverBytes(_X, _Y &#43; 1) = CELLSTATE.Free Or solverBytes(_X, _Y &#43; 1) = CELLSTATE.Start Or solverBytes(_X, _Y &#43; 1) = CELLSTATE.Finish Then
            solverBytes(_X, _Y &#43; 1) = CELLSTATE.Valid
            If Solve(_X, _Y &#43; 1) Then Return True
        End If

        If solverBytes(_X, _Y - 1) = CELLSTATE.Free Or solverBytes(_X, _Y &#43; 1) = CELLSTATE.Start Or solverBytes(_X, _Y &#43; 1) = CELLSTATE.Finish Then
            solverBytes(_X, _Y - 1) = CELLSTATE.Valid
            If Solve(_X, _Y - 1) Then Return True
        End If

        Return False
    End Function</pre>
<div class="preview">
<pre class="vbs"><span class="vbScript__com">'&nbsp;Generic&nbsp;Function&nbsp;to&nbsp;retrieve&nbsp;a&nbsp;2D&nbsp;maze&nbsp;solution's&nbsp;domain</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">Private</span>&nbsp;<span class="vbScript__keyword">Function</span>&nbsp;Solve(_X&nbsp;<span class="vbScript__keyword">As</span>&nbsp;<span class="vbScript__keyword">Integer</span>,&nbsp;_Y&nbsp;<span class="vbScript__keyword">As</span>&nbsp;<span class="vbScript__keyword">Integer</span>)&nbsp;<span class="vbScript__keyword">As</span>&nbsp;<span class="vbScript__keyword">Boolean</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">If</span>&nbsp;solverBytes(_endPos(<span class="vbScript__number">0</span>),&nbsp;_endPos(<span class="vbScript__number">1</span>))&nbsp;=&nbsp;CELLSTATE.Valid&nbsp;<span class="vbScript__keyword">Then</span>&nbsp;<span class="vbScript__keyword">Return</span>&nbsp;<span class="vbScript__keyword">True</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">If</span>&nbsp;solverBytes(_X&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>,&nbsp;_Y)&nbsp;=&nbsp;CELLSTATE.Free&nbsp;<span class="vbScript__keyword">Or</span>&nbsp;solverBytes(_X&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>,&nbsp;_Y)&nbsp;=&nbsp;CELLSTATE.Start&nbsp;<span class="vbScript__keyword">Or</span>&nbsp;solverBytes(_X&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>,&nbsp;_Y)&nbsp;=&nbsp;CELLSTATE.Finish&nbsp;<span class="vbScript__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solverBytes(_X&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>,&nbsp;_Y)&nbsp;=&nbsp;CELLSTATE.Valid&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">If</span>&nbsp;Solve(_X&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>,&nbsp;_Y)&nbsp;<span class="vbScript__keyword">Then</span>&nbsp;<span class="vbScript__keyword">Return</span>&nbsp;<span class="vbScript__keyword">True</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">End</span>&nbsp;<span class="vbScript__keyword">If</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">If</span>&nbsp;solverBytes(_X&nbsp;-&nbsp;<span class="vbScript__number">1</span>,&nbsp;_Y)&nbsp;=&nbsp;CELLSTATE.Free&nbsp;<span class="vbScript__keyword">Or</span>&nbsp;solverBytes(_X&nbsp;-&nbsp;<span class="vbScript__number">1</span>,&nbsp;_Y)&nbsp;=&nbsp;CELLSTATE.Start&nbsp;<span class="vbScript__keyword">Or</span>&nbsp;solverBytes(_X&nbsp;-&nbsp;<span class="vbScript__number">1</span>,&nbsp;_Y)&nbsp;=&nbsp;CELLSTATE.Finish&nbsp;<span class="vbScript__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solverBytes(_X&nbsp;-&nbsp;<span class="vbScript__number">1</span>,&nbsp;_Y)&nbsp;=&nbsp;CELLSTATE.Valid&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">If</span>&nbsp;Solve(_X&nbsp;-&nbsp;<span class="vbScript__number">1</span>,&nbsp;_Y)&nbsp;<span class="vbScript__keyword">Then</span>&nbsp;<span class="vbScript__keyword">Return</span>&nbsp;<span class="vbScript__keyword">True</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">End</span>&nbsp;<span class="vbScript__keyword">If</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">If</span>&nbsp;solverBytes(_X,&nbsp;_Y&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>)&nbsp;=&nbsp;CELLSTATE.Free&nbsp;<span class="vbScript__keyword">Or</span>&nbsp;solverBytes(_X,&nbsp;_Y&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>)&nbsp;=&nbsp;CELLSTATE.Start&nbsp;<span class="vbScript__keyword">Or</span>&nbsp;solverBytes(_X,&nbsp;_Y&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>)&nbsp;=&nbsp;CELLSTATE.Finish&nbsp;<span class="vbScript__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solverBytes(_X,&nbsp;_Y&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>)&nbsp;=&nbsp;CELLSTATE.Valid&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">If</span>&nbsp;Solve(_X,&nbsp;_Y&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>)&nbsp;<span class="vbScript__keyword">Then</span>&nbsp;<span class="vbScript__keyword">Return</span>&nbsp;<span class="vbScript__keyword">True</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">End</span>&nbsp;<span class="vbScript__keyword">If</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">If</span>&nbsp;solverBytes(_X,&nbsp;_Y&nbsp;-&nbsp;<span class="vbScript__number">1</span>)&nbsp;=&nbsp;CELLSTATE.Free&nbsp;<span class="vbScript__keyword">Or</span>&nbsp;solverBytes(_X,&nbsp;_Y&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>)&nbsp;=&nbsp;CELLSTATE.Start&nbsp;<span class="vbScript__keyword">Or</span>&nbsp;solverBytes(_X,&nbsp;_Y&nbsp;&#43;&nbsp;<span class="vbScript__number">1</span>)&nbsp;=&nbsp;CELLSTATE.Finish&nbsp;<span class="vbScript__keyword">Then</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solverBytes(_X,&nbsp;_Y&nbsp;-&nbsp;<span class="vbScript__number">1</span>)&nbsp;=&nbsp;CELLSTATE.Valid&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">If</span>&nbsp;Solve(_X,&nbsp;_Y&nbsp;-&nbsp;<span class="vbScript__number">1</span>)&nbsp;<span class="vbScript__keyword">Then</span>&nbsp;<span class="vbScript__keyword">Return</span>&nbsp;<span class="vbScript__keyword">True</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">End</span>&nbsp;<span class="vbScript__keyword">If</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">Return</span>&nbsp;<span class="vbScript__keyword">False</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="vbScript__keyword">End</span>&nbsp;<span class="vbScript__keyword">Function</span></pre>
</div>
</div>
</div>
<h1>Graphical example of program execution</h1>
<p><img id="133143" src="description/05_exec.png" alt="" width="659" height="836"></p>
<h1><span>Source Code Files</span></h1>
<ul>
<li><em>GAMazeSolve.zip - Visual Studio solution and source code</em> </li><li><em><em>test_maze.txt - Included in the previous zip, it contains a pre-created 2D maze to be used with the sample.</em></em>
</li></ul>
<h1>More Information</h1>
<p><em>For more information about the topic, you can refer to my TechNet article at:&nbsp;<a href="http://social.technet.microsoft.com/wiki/contents/articles/29756.algoritmi-genetici-nella-risoluzione-di-labirinti-bidimensionali-it-it.aspx" >http://social.technet.microsoft.com/wiki/contents/articles/29756.algoritmi-genetici-nella-risoluzione-di-labirinti-bidimensionali-it-it.aspx</a></em></p>
<p><em>It is available in Italian only, but soon i will provide English translation. Please refer to this page to know the link when it will be ready.</em></p>

</div>


    </div>
</body>
</html>
